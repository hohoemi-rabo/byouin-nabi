# 006 - ç—…é™¢æ¤œç´¢ãƒ»è¡¨ç¤ºæ©Ÿèƒ½

## æ¦‚è¦
è¨ºç™‚ç§‘ã«åŸºã¥ã„ã¦ç—…é™¢ã‚’æ¤œç´¢ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¡¨ç¤ºã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

## ç›®çš„
- æ¨å¥¨è¨ºç™‚ç§‘ã«å¯¾å¿œã™ã‚‹ç—…é™¢ã®æ¤œç´¢
- ç—…é™¢æƒ…å ±ã®è¦‹ã‚„ã™ã„è¡¨ç¤º
- é›»è©±ãƒ»åœ°å›³ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹

## ã‚¿ã‚¹ã‚¯

### API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä½œæˆ
- [x] GET /api/hospitals - å…¨ç—…é™¢å–å¾—
- [x] GET /api/hospitals/search - è¨ºç™‚ç§‘ã§ã®æ¤œç´¢
- [x] ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å‡¦ç†
- [x] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### Supabase ã‚¯ã‚¨ãƒªå®Ÿè£…
- [x] è¨ºç™‚ç§‘ã§ã®çµã‚Šè¾¼ã¿ã‚¯ã‚¨ãƒª
- [x] ä¸¦ã³é †ã®å®Ÿè£…ï¼ˆå°‚é–€æ€§å„ªå…ˆï¼‰
- [ ] ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå°†æ¥å¯¾å¿œï¼‰ â€»åˆæœŸãƒªãƒªãƒ¼ã‚¹ã§ã¯ã‚¹ã‚­ãƒƒãƒ—

### ç—…é™¢ãƒªã‚¹ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- [x] HospitalList ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä½œæˆ
- [x] HospitalCard ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä½œæˆ
- [x] LoadingçŠ¶æ…‹ã®è¡¨ç¤º
- [x] ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã®è¡¨ç¤º
- [x] ãƒ‡ãƒ¼ã‚¿ãªã—çŠ¶æ…‹ã®è¡¨ç¤º

### ç—…é™¢ã‚«ãƒ¼ãƒ‰è¡¨ç¤ºå†…å®¹
- [x] ç—…é™¢åï¼ˆå¤§ããè¡¨ç¤ºï¼‰
- [x] è¨ºç™‚ç§‘ï¼ˆè©²å½“ç§‘ã‚’å¼·èª¿ï¼‰
- [x] ä½æ‰€
- [x] é›»è©±ç•ªå·ï¼ˆã‚¿ãƒƒãƒ—ã§ç™ºä¿¡ï¼‰
- [x] è¨ºç™‚æ™‚é–“
- [x] åœ°å›³ãƒœã‚¿ãƒ³ï¼ˆGoogle Mapsï¼‰
- [x] å‚™è€ƒ

## å®Ÿè£…ä¾‹

```typescript
// src/app/api/hospitals/search/route.ts
import { NextRequest, NextResponse } from 'next/server';
import { supabase } from '@/lib/supabase';

export async function GET(request: NextRequest) {
  try {
    const searchParams = request.nextUrl.searchParams;
    const categories = searchParams.get('categories')?.split(',') || [];

    if (categories.length === 0) {
      return NextResponse.json(
        { error: 'è¨ºç™‚ç§‘ã‚’æŒ‡å®šã—ã¦ãã ã•ã„' },
        { status: 400 }
      );
    }

    const { data: hospitals, error } = await supabase
      .from('hospitals')
      .select('*')
      .contains('category', categories)
      .order('name');

    if (error) {
      throw error;
    }

    return NextResponse.json({ hospitals });
  } catch (error) {
    console.error('Hospital search error:', error);
    return NextResponse.json(
      { error: 'ç—…é™¢ã®æ¤œç´¢ã«å¤±æ•—ã—ã¾ã—ãŸ' },
      { status: 500 }
    );
  }
}
```

```typescript
// src/components/HospitalList/HospitalCard.tsx
interface Hospital {
  id: string;
  name: string;
  category: string[];
  address: string;
  tel: string;
  city: string;
  opening_hours?: string;
  google_map_url?: string;
  note?: string;
}

export default function HospitalCard({
  hospital,
  highlightCategories = []
}: {
  hospital: Hospital;
  highlightCategories?: string[];
}) {
  return (
    <div className="border rounded-lg p-6 shadow-sm hover:shadow-md transition">
      <h3 className="text-2xl font-bold mb-2">{hospital.name}</h3>

      <div className="mb-3">
        <span className="text-sm text-gray-600">è¨ºç™‚ç§‘ï¼š</span>
        <div className="flex flex-wrap gap-2 mt-1">
          {hospital.category.map(cat => (
            <span
              key={cat}
              className={`px-3 py-1 rounded-full text-sm ${
                highlightCategories.includes(cat)
                  ? 'bg-primary text-white font-bold'
                  : 'bg-gray-100'
              }`}
            >
              {cat}
            </span>
          ))}
        </div>
      </div>

      <div className="space-y-2 text-base">
        <p>ğŸ“ {hospital.address}</p>
        <p>
          ğŸ“ <a href={`tel:${hospital.tel}`} className="text-primary underline">
            {hospital.tel}
          </a>
        </p>
        {hospital.opening_hours && (
          <p>ğŸ• {hospital.opening_hours}</p>
        )}
      </div>

      <div className="mt-4 flex gap-3">
        {hospital.google_map_url && (
          <a
            href={hospital.google_map_url}
            target="_blank"
            rel="noopener noreferrer"
            className="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700"
          >
            åœ°å›³ã§è¦‹ã‚‹
          </a>
        )}
      </div>

      {hospital.note && (
        <p className="mt-3 text-sm text-gray-600 border-t pt-3">
          â„¹ï¸ {hospital.note}
        </p>
      )}
    </div>
  );
}
```

## å—ã‘å…¥ã‚ŒåŸºæº–
- [x] è¨ºç™‚ç§‘ã§ç—…é™¢ãŒæ­£ã—ãçµã‚Šè¾¼ã¾ã‚Œã‚‹
- [x] ç—…é™¢æƒ…å ±ãŒè¦‹ã‚„ã™ãè¡¨ç¤ºã•ã‚Œã‚‹
- [x] é›»è©±ç•ªå·ã‚¿ãƒƒãƒ—ã§ç™ºä¿¡ã§ãã‚‹
- [x] åœ°å›³ãƒœã‚¿ãƒ³ã§Google MapsãŒé–‹ã
- [x] è©²å½“ã™ã‚‹è¨ºç™‚ç§‘ãŒå¼·èª¿è¡¨ç¤ºã•ã‚Œã‚‹
- [x] ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã«é©åˆ‡ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [x] ã‚¨ãƒ©ãƒ¼æ™‚ã«é©åˆ‡ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹

## ä¾å­˜é–¢ä¿‚
- 001-ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆãƒ»æ§‹ç¯‰
- 005-è¨ºç™‚ç§‘ãƒãƒƒãƒ”ãƒ³ã‚°æ©Ÿèƒ½

## é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«
- `/home/masayuki/NextJs/byouin-nabi/src/app/api/hospitals/route.ts`
- `/home/masayuki/NextJs/byouin-nabi/src/app/api/hospitals/search/route.ts`
- `/home/masayuki/NextJs/byouin-nabi/src/components/HospitalList/`
- `/home/masayuki/NextJs/byouin-nabi/src/app/results/page.tsx`

## å‚™è€ƒ
- åˆæœŸãƒªãƒªãƒ¼ã‚¹ã§ã¯å…¨ä»¶è¡¨ç¤ºï¼ˆãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³æœªå®Ÿè£…ï¼‰
- ç—…é™¢æ•°ãŒå¢—ãˆãŸå ´åˆã¯ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 
- è·é›¢é †ã‚½ãƒ¼ãƒˆã¯å°†æ¥å¯¾å¿œï¼ˆä½ç½®æƒ…å ±APIä½¿ç”¨ï¼‰

# 008 - ç®¡ç†ç”»é¢æ§‹ç¯‰

## æ¦‚è¦
ç—…é™¢ãƒ‡ãƒ¼ã‚¿ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®ç®¡ç†ç”»é¢ã®åŸºæœ¬æ§‹é€ ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚

## ç›®çš„
- ç®¡ç†è€…å°‚ç”¨ã®UIã‚’ä½œæˆ
- èªè¨¼ã‚¬ãƒ¼ãƒ‰æ©Ÿèƒ½ã®å®Ÿè£…
- ç®¡ç†ç”»é¢ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæ§‹ç¯‰

## ã‚¿ã‚¹ã‚¯

### ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ§‹é€ 
- [ ] /admin ãƒ«ãƒ¼ãƒˆä½œæˆ
- [ ] /admin/layout.tsx ä½œæˆï¼ˆç®¡ç†ç”»é¢å°‚ç”¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼‰
- [ ] /admin/dashboard ãƒšãƒ¼ã‚¸ä½œæˆ
- [ ] /admin/hospitals ãƒšãƒ¼ã‚¸ä½œæˆ

### èªè¨¼æ©Ÿèƒ½ï¼ˆSupabase Authï¼‰
- [ ] Supabase Auth ã®è¨­å®š
- [ ] ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½œæˆ
- [ ] ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ä½œæˆï¼ˆ/admin/loginï¼‰
- [ ] ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ©Ÿèƒ½
- [ ] èªè¨¼çŠ¶æ…‹ã®ç®¡ç†ï¼ˆContextï¼‰

### Middleware ã«ã‚ˆã‚‹ä¿è­·
- [ ] middleware.ts ã®ä½œæˆ
- [ ] /admin/* ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- [ ] æœªèªè¨¼æ™‚ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ

### ç®¡ç†ç”»é¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
- [ ] AdminLayout ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä½œæˆ
- [ ] ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
- [ ] ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆãƒ­ã‚°ã‚¢ã‚¦ãƒˆãƒœã‚¿ãƒ³ï¼‰
- [ ] ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢

### ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- [ ] ç—…é™¢æ•°ã®è¡¨ç¤º
- [ ] æœ€è¿‘è¿½åŠ ã•ã‚ŒãŸç—…é™¢
- [ ] ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

## å®Ÿè£…ä¾‹

```typescript
// middleware.ts
import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';

export function middleware(request: NextRequest) {
  const adminToken = request.cookies.get('admin-token');

  // ç®¡ç†ç”»é¢ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹
  if (request.nextUrl.pathname.startsWith('/admin')) {
    // ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã¯é™¤å¤–
    if (request.nextUrl.pathname === '/admin/login') {
      return NextResponse.next();
    }

    // æœªèªè¨¼ã®å ´åˆã¯ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
    if (!adminToken) {
      return NextResponse.redirect(new URL('/admin/login', request.url));
    }
  }

  return NextResponse.next();
}

export const config = {
  matcher: '/admin/:path*',
};
```

```typescript
// src/app/admin/layout.tsx
import AdminSidebar from '@/components/Admin/AdminSidebar';
import AdminHeader from '@/components/Admin/AdminHeader';

export default function AdminLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <div className="flex h-screen bg-gray-100">
      <AdminSidebar />
      <div className="flex-1 flex flex-col">
        <AdminHeader />
        <main className="flex-1 overflow-y-auto p-6">
          {children}
        </main>
      </div>
    </div>
  );
}
```

```typescript
// src/components/Admin/AdminSidebar.tsx
import Link from 'next/link';

export default function AdminSidebar() {
  return (
    <aside className="w-64 bg-gray-800 text-white">
      <div className="p-4">
        <h2 className="text-xl font-bold">ç®¡ç†ç”»é¢</h2>
      </div>
      <nav className="mt-4">
        <Link
          href="/admin/dashboard"
          className="block px-4 py-3 hover:bg-gray-700"
        >
          ğŸ“Š ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
        </Link>
        <Link
          href="/admin/hospitals"
          className="block px-4 py-3 hover:bg-gray-700"
        >
          ğŸ¥ ç—…é™¢ç®¡ç†
        </Link>
      </nav>
    </aside>
  );
}
```

## å—ã‘å…¥ã‚ŒåŸºæº–
- [ ] /admin ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨èªè¨¼ãƒã‚§ãƒƒã‚¯ãŒè¡Œã‚ã‚Œã‚‹
- [ ] æœªèªè¨¼æ™‚ã¯ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹
- [ ] ãƒ­ã‚°ã‚¤ãƒ³å¾Œã«ç®¡ç†ç”»é¢ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹
- [ ] ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ©Ÿèƒ½ã™ã‚‹
- [ ] ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ãŒé©ç”¨ã•ã‚Œã¦ã„ã‚‹

## ä¾å­˜é–¢ä¿‚
- 000-ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

## é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«
- `/home/masayuki/NextJs/byouin-nabi/middleware.ts`
- `/home/masayuki/NextJs/byouin-nabi/src/app/admin/layout.tsx`
- `/home/masayuki/NextJs/byouin-nabi/src/app/admin/login/page.tsx`
- `/home/masayuki/NextJs/byouin-nabi/src/app/admin/dashboard/page.tsx`
- `/home/masayuki/NextJs/byouin-nabi/src/components/Admin/`

## å‚™è€ƒ
- ç®¡ç†è€…ã¯1åã®ã¿
- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´æ©Ÿèƒ½ã¯å°†æ¥å®Ÿè£…
- 2è¦ç´ èªè¨¼ã¯å°†æ¥å¯¾å¿œã‚’æ¤œè¨
